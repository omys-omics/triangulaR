<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="triangulaR">
<title>Triangle Plot Basics • triangulaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Triangle Plot Basics">
<meta property="og:description" content="triangulaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">triangulaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/triangle_plot_basics.html">Triangle Plot Basics</a>
    <a class="dropdown-item" href="../articles/explore_triangle_plots.html">Explore Triangle Plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/omys-omics/triangulaR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Triangle Plot Basics</h1>
                        <h4 data-toc-skip class="author">Ben Wiens</h4>
            
            <h4 data-toc-skip class="date">4/9/2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/omys-omics/triangulaR/blob/HEAD/vignettes/triangle_plot_basics.Rmd" class="external-link"><code>vignettes/triangle_plot_basics.Rmd</code></a></small>
      <div class="d-none name"><code>triangle_plot_basics.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="identifying-aims">Identifying AIMs<a class="anchor" aria-label="anchor" href="#identifying-aims"></a>
</h3>
<p>In order to build triangle plots, the first thing we need to do is
identify ancestry-informative markers (AIMs). These are SNPs that have
alleles that are sorted between two distinct parental groups, which
means that each allele at a SNP indicates ancestry from one parental
group or the other. In this example, we are going to assume that there
are only two alleles at each SNP, which is also how empircal datasets
are often treated. Consider the two populations shown below. Each
population consists of diploid organisms, and six SNPs are shown on the
example chromosomes. We can see that population 1 only has red alleles
at SNPs 1, 2, 4, and 6, and that there are some blue alleles at SNPs 3
and 5. If we look at population 2, we see that there are only blue
alleles at SNPs 1, 2, 3, 4, and 6. So, both populations have both
alleles at site 5, and population 1 has both alleles at site 3.
Therefore, only sites 1, 2, 4, and 6 are completely informative
ancestry. When alleles at a SNP are completely sorted between
populations, we call this a fixed difference. Moving forward in this
example, we will use SNPs 1, 2, 4, and 6 as AIMs.</p>
<p><img src="../reference/figures/parental_pops.png"><span class="math display">\[\\[0.05in]\]</span></p>
</div>
<div class="section level3">
<h3 id="calculating-hybrid-index-and-interclass-heterozygosity">Calculating Hybrid Index and Interclass Heterozygosity<a class="anchor" aria-label="anchor" href="#calculating-hybrid-index-and-interclass-heterozygosity"></a>
</h3>
<p><img src="../reference/figures/first_cross.png" align="left" alt="" width="260">
One thing triangle plots can help do is identify early generation
hybrids, such as F1s. An F1 is the offspring of a cross between an
individual from parental population 1 and parental population 2. The
illustration to the left shows the alleles present at the AIMs we have
identified. Because offspring inherit one allele from each parent, we
can see that the F1 has a blue allele and a red allele at each AIM. In
order to build a triangle plot, we first need to calculate hybrid index
and interclass heterozygosity. Hybrid index is calculated by counting
the number of alleles inherited from parental population 2, and dividing
by the total number of alleles. This gives us a value that can range
between 0 and 1. In this case, the F1 has four alleles from parental
population 2 (blue), and eight total alleles. This gives a hybrid index
of <span class="math inline">\(\frac{4}{8}=0.5\)</span>. Interclass
heterozygosity is calculated by counting the number of AIMs that have an
allele from both parental populations, and dividing by total number of
AIMs. In this case there are four AIMs that have an allele from both
parental populations, and four total AIMs, meaning the interclass
heterozygosity is <span class="math inline">\(\frac{4}{4}=1\)</span>.</p>
<p><img src="../reference/figures/second_cross.png" align="left" alt="" width="260">
Let’s consider another type of cross. The illustration to the left shows
the offspring of a cross between two F1s, called an F2. We can calculate
hybrid index and interclass heterozygosity for the F2 manually as we did
above. In the F2, we see there are four alleles from parental population
2 (blue), so hybrid index is <span class="math inline">\(\frac{4}{8}=0.5\)</span>. In contrast to the F1
though, the F2 only has two AIMs with alleles from both parental
populations, so interclass heterozygosity is <span class="math inline">\(\frac{2}{4}=0.5\)</span>. These are the expected
values for an F2, as we will see in the next section. <span class="math display">\[\\[0.1in]\]</span></p>
</div>
<div class="section level3">
<h3 id="punnett-squares">Punnett Squares
<img src="../reference/figures/punnett_squares.png" align="right" alt="" width="280"><a class="anchor" aria-label="anchor" href="#punnett-squares"></a>
</h3>
<p>Another way to think about the expected genotypes in hybrid offspring
is with Punnett squares. The Punnett square on the top shows the
possible genotypes at an AIM in an F1. Because the parents are
homozygous for different alleles, the only possible genotype is <span class="math inline">\(p_{12}\)</span>. Since the parents have the same
genotype at all AIMs, F1s will have the <span class="math inline">\(p_{12}\)</span> genotype at all AIMs.</p>
<p>Now let’s look at a Punnett square for a cross between two F1s. We
see that for any given AIM, there are three possible genotypes in an F2.
There is a 25% chance of the <span class="math inline">\(p_{11}\)</span>
genotype, a 50% chance of the <span class="math inline">\(p_{12}\)</span> genotype, and a 25% chance of the
<span class="math inline">\(p_{22}\)</span> genotype. At any given AIM,
the F2 can only have one genotype, but if we had a dataset of 100 AIMs,
we would expect that 25 would display the <span class="math inline">\(p_{11}\)</span> genotype, 50 would display the
<span class="math inline">\(p_{12}\)</span> genotype, and 25 would
display <span class="math inline">\(p_{22}\)</span> genotype.</p>
</div>
<div class="section level3">
<h3 id="borders-of-a-triangle-plot">Borders of a Triangle Plot<a class="anchor" aria-label="anchor" href="#borders-of-a-triangle-plot"></a>
</h3>
<p><img src="../reference/figures/labeled_tri_plot.png" align="left" alt="" width="400">
So, after seeing how hybrid index and interclass heterozygosity are
calculated, let’s see where individuals appear on a triangle plot. On
the plot to the left, we can see that F1s and F2s both have a hybrid
index of 0.5, but can be distinguished because F1s have an interclass
heterozygosity of 1. BC on the plot stands for “backcross”. A backcross
is when a hybrid crosses with parental individual. BC1 indicates the
offspring of a cross between an F1 and a member of parental population 1
(P1). BC2 indicates a cross between BC1 and P1, and so forth. The solid
black lines forming a triangle indicate the possible space on the plot.
All individuals must be either on the lines or within the triangle. This
is because hybrid index and interclass heterozygosity are not fully
independent of each other. To see why, let’s consider the example
below.</p>
<p><img src="../reference/figures/possible_space.png"></p>
<p>The triangle plots above show an invalid (left) and valid (right)
combination of hybrid index and interclass heterozygosity. Let’s say we
used 100 AIMs to calculate hybrid index and interclass heterozygosity.
To see why the gray point with the red X next to it is not possible,
let’s consider the implications of its interclass heterozygosity. An
interclass heterozygosity of 0.6 means that of the 100 AIMs, 60 of them
are heterozygous, or have a genotype of <span class="math inline">\(p_{12}\)</span>. So, we know there are a minimum
of 30 <span class="math inline">\(p_2\)</span> alleles. Thus, even if
the genotype at every other AIM is <span class="math inline">\(p_{11}\)</span>, there are still 30 <span class="math inline">\(p_2\)</span> alleles, meaning the hybrid index is
<span class="math inline">\(\frac{30}{100}=0.3\)</span>. So, the
combination of a hybrid index of 0.25 and interclass heterozygosity of
0.6 is impossible, because a hybrid index of 0.25 means there can be at
most 25 <span class="math inline">\(p_2\)</span> alleles but an
interclass heterozygosity of 0.6 means there must be at least 30 <span class="math inline">\(p_2\)</span> alleles.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ben Wiens.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
